{% extends 'base.html.twig' %}

{% block body %}
<div class="max-w-6xl mx-auto py-10">

    <!-- Header -->
    <div class="flex justify-between items-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800">My Tasks</h1>

        <a href="{{ path('task_new') }}"
           class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-lg shadow">
            + New Task
        </a>
    </div>

    <!-- Task Card -->
    <div class="bg-white rounded-xl shadow divide-y">

        {% for task in tasks %}
    <div class="flex items-center justify-between px-6 py-4 hover:bg-gray-50">

        <!-- Left -->
        <div class="flex items-center gap-4">

            <!-- Toggle completed -->
            <form method="post"
                action="{{ path('task_toggle', {id: task.id}) }}">
                <button
                    class="w-5 h-5 flex items-center justify-center rounded border
                        {% if task.completed %}
                            bg-indigo-600 border-indigo-600 text-white
                        {% else %}
                            border-gray-400
                        {% endif %}"
                    title="Toggle completed">
                    <span class="text-xs">
                        {% if task.completed %}‚úì{% endif %}
                    </span>
                </button>
            </form>

            <!-- Title -->
            <span class="text-lg
                {% if task.completed %}
                    line-through text-gray-400
                {% else %}
                    text-gray-800
                {% endif %}
            ">
                {{ task.title }}
            </span>

            <!-- Priority -->
            <span class="text-xs font-semibold px-3 py-1 rounded-full
                {% if task.priority == 'HIGH' %}
                    bg-red-100 text-red-600
                {% elseif task.priority == 'MEDIUM' %}
                    bg-yellow-100 text-yellow-700
                {% else %}
                    bg-green-100 text-green-600
                {% endif %}
            ">
                {{ task.priority }}
            </span>
        </div>

        <!-- Actions -->
        <div class="flex items-center gap-4">
            <a href="{{ path('task_edit', {id: task.id}) }}"
            class="text-blue-500 hover:text-blue-700">
                ‚úèÔ∏è
            </a>

            <form method="post"
                action="{{ path('task_delete', {id: task.id}) }}"
                onsubmit="return confirm('Delete this task?');">
                <input type="hidden" name="_token"
                    value="{{ csrf_token('delete' ~ task.id) }}">
                <button class="text-red-500 hover:text-red-700">
                    üóëÔ∏è
                </button>
            </form>
        </div>
    </div>
    {% else %}
    <p class="text-center py-8 text-gray-500">No tasks yet</p>
    {% endfor %}
    </div>

    <!-- Footer Stats -->
    <div class="mt-6 bg-white rounded-lg shadow px-6 py-4 flex justify-between text-sm text-gray-600">
        <span>Total: {{ total }}</span>
        <span>Completed: {{ completed }}</span>
        <span>Remaining: {{ total - completed }}</span>
    </div>

</div>
{% endblock %}
